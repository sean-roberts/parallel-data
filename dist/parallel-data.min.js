// ParallelData v1.0.0 by Sean Roberts @DevelopSean
!function(){"use strict";var e={},t=function(e,t){return e.toUpperCase()+"-"+t},n=function(n,s,_,r){var i=t(n,s);if(!e[i]){var a=new XMLHttpRequest,o=e[i]={url:s,method:n,headers:_,xhrRef:a,events:{load:null,error:null,timeout:null}};a.__PDInternal__=!0,a.open(n,s),Object.keys(_||{}).forEach(function(e){a.setRequestHeader(e,_[e])}),Object.keys(o.events).forEach(function(e){a.addEventListener(e,function(t){console.log("Event fired",e,t),o.events[e]=t})}),a.send()}};!function(){var e=XMLHttpRequest.prototype;e.__PDListeners__=[],Object.keys(e).forEach(function(t){var n=Object.getOwnPropertyDescriptor(e,t);void 0===n.value&&Object.defineProperty(e,t,Object.assign({},n,{get:function(){return!this.__PDInternal__&&this.__PDRequest__?this.__PDRequest__[t]:n.get.call(this)}}))});var t=e.open;e.open=function(e,n){this.__PDOpen__={method:e,url:n},t.apply(this,arguments)};var n=e.addEventListener;e.addEventListener=function(){if(!this.__PDInternal__){if(this.__PDRequest__)return this.__PDRequest__.addEventListener.apply(this.__PDRequest__,arguments);this.__PDListeners__.push({action:"add",args:arguments})}return n.apply(this,arguments)};var s=e.removeEventListener;e.removeEventListener=function(){if(!this.__PDInternal__){if(this.__PDRequest__)return this.__PDRequest__.removeEventListener.apply(this.__PDRequest__,arguments);this.__PDListeners__.push({action:"remove",args:arguments})}return s.apply(this,arguments)};var _=e.send;e.send=function(e){var t=this,n=window.ParallelData.getRequestReference(this.__PDOpen__),s=n&&n.xhrRef;this.__PDInternal__||!s||s.__PDConsumed__?_.call(this,e):(s.__PDConsumed__=!0,(window.setImmediate||window.setTimeout)(function(){s.onreadystatechange=t.onreadystatechange,Object.keys(XMLHttpRequestEventTarget.prototype).forEach(function(e){s[e]=t[e]}),t.__PDListeners__.forEach(function(e){s[e.action+"EventListener"].apply(s,e.args)}),t.__PDRequest__=s,s.onreadystatechange&&s.onreadystatechange(),Object.keys(n.events).forEach(function(e){n.events[e]&&t.dispatchEvent(n.events[e])})},0))}}(),window.ParallelData={version:"1.0.0",get:function(e,t){n("GET",e,(t=t||{}).headers)},getRequestReference:function(n){var s=t(n.method,n.url);return e[s]},config:function(e){}}}();
